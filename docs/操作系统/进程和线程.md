# 进程和线程


## 进程
- 进程是一个可并发执行的应用程序关于某个数据集合的一次执行过程

- 它是操作系统进程资源分配和保护的基本单位



## 线程
- 线程是进程的一部分，它是进程内的一个执行体

- 线程是比进程更小的能独立运行的基本单位


## 为什么要引入线程

- 操作系统引入进程的目的是为了使多个程序并发执行，以提高资源的利用率和系统的吞吐量

- 而操作系统引入线程的目的是为了减少程序并发执行是所付出的时空开销，使得操作系统有更好的并发性


## 二者的区别和联系
- 一个进程包含有多个线程，至少有一个线程

- 一个进程的多个线程都在进程的地址空间里活动

- 在引入线程的操作系统里，资源分配的对象是进程，而不是线程。进程仍然是拥有资源的一个独立单位，它拥有自己的资源。而线程除了一点必不可少的资源外不拥有系统资源，线程使用的是进程分到的资源

- 在引入操作线程的操作系统里面，调度的基本单位是线程而不是进程，即在CPU上执行的是线程。

- 进程可以并发执行，进程中的线程也可以并发执行，同时需要协作同步

- 进程调度系统需要进程上下文的切换，需要大量的开销

- 线程调度，由于统一进程的线程使用的是共享进程的资源，所以线程切换比进程切换更快

- 一个进程的线程切换到另一个进程的线程，会引起进程的上下文切换

- 从安全角度说，进程比线程安全

- 通信：进程间 以IPC（管道，信号量，共享内存，消息队列，文件，套接字等）方式通信。同一个进程下，线程间可以共享全局变量、静态变量等数据进行通信，做到同步和互斥，以保证数据的一致性

- 执行过程：每个进程都有一个程序执行的入口，顺序执行序列；线程不能够独立执行，必须依存在应用程序中，由程序的多线程控制机制控制

- 健壮性：每个进程之间的资源是独立的，当一个进程崩溃时，不会影响其他进程；同一进程的线程共享此线程的资源，当一个线程发生崩溃时，此进程也会发生崩溃，稳定性差，容易出现共享与资源竞争产生的各种问题，如死锁等

- 可维护性：线程的可维护性，代码也较难调试，bug 难排查

## 进程和线程的选择
- 需要频繁创建销毁的优先使用线程。因为进程创建、销毁一个进程代价很大，需要不停的分配资源；线程频繁的调用只改变 CPU 的执行

- 线程的切换速度快，需要大量计算，切换频繁时，用线程
- 耗时的操作使用线程可提高应用程序的响应
- 线程对 CPU 的使用效率更优，多机器分布的用进程，多核分布用线程

- 需要跨机器移植，优先考虑用进程
- 需要更稳定、安全时，优先考虑用进程
- 需要速度时，优先考虑用线程
- 并行性要求很高时，优先考虑用线程