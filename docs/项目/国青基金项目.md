
# 国青基金项目

## IVUS
冠心病是常见的心血管疾病。

临床上用于辅助诊断和治疗的方法有冠状动脉造影（CAG）和血管内超声成像（IVUS）。

冠脉造影存在无法显示血管内情况的缺陷，而血管内超声在对血管内的情况诊查可以补充血管造影图的不足。

IVUS能够精确测定血管管腔、直径以及判断病变严重程度及性质，在提高对冠状动脉病变的认识、早期筛查和临床诊断上均发挥着重要作用。


## 关键帧提取
通过对比不同帧之间的差异来判断其关联性。

现有的文献来看，关键帧提取算法主要分为几个类别，包括基于镜头的关键帧提取算法，
基于内容的关键帧提取算法，基于运动分析的关键帧提取算法，基于聚类的关键帧提取算法等等。

### 1. 基于镜头的算法
基于镜头的关键帧提取算法主要是使用镜头边界检测算法一个视频影像分为不同的镜头，然后提取同镜头中的首尾帧或者中间帧作为关键帧。

### 2. 基于内容的算法
基于内容的关键帧提取算法主要是提取视频帧图像的特征，包括颜色、纹理、形状等特征，以及通过卷积神经网络得到的卷积特征等，
然后计算特征的差异性来选择关键帧图像。

### 3. 基于运动分析的算法
基于运动分析的关键帧提取算法主要是通过光流法来分析物体的运动量，选择运动量小的视频帧作为局部的关键帧。

### 4. 基于聚类的算法
基于聚类的关键帧提取算法则是将所有视频帧图像分为不同的簇，然后在每个簇中选择一定数量的图像作为关键帧。


## 图像检索
### 1. 基于文本的图像检索技术
主要是通过文本内容以关键词的方式对图像进行检索。在检索之前，需要人工对数据库图像进行标注，然后对标注文本以及图像固有的属性，
比如图像名称、大小、长宽、分辨率、时间日期等建立关键词，使得可以通过关键词进行搜索匹配，从而实现图像检索。


### 2. 基于内容的图像检索技术
通过提取图像特征，然后通过相似性度量来判断图像之间的关联性，从而达到图像检索的目的。

基于内容的图像检索的一般步骤主要包括有特征提取、特征处理、相似性度量等。
我们采用卷积神经网络提取图像特征相较于传统的颜色、纹理、形状等特征更能代表图像的全局特征，在对图像进行相似性度量时才能更加准确的衡量图像之间的差异。


## 本项目方法

数据库图像 ----> ADSH算法得到对应的哈希码 ---> 使用 k-means++ 进行聚类
----> 筛选得到关键帧图像集合 ---->


### k-means++
图像对应的哈希码作为其特征，并采用Hamming距离作为距离或者相似性的度量方法.

通过该方法，k-means++算法将视频帧图像分为不同的簇，对于每个簇中的图像，我们同样采用Hamming距离来计算图像之间的相似度。

即第一次使用聚类算法得到不同的簇，然后在不同的簇内 计算 均值 和各个视频帧之间的距离，
筛选得到候选帧集合。然后在使用候选帧集合 计算图像帧之间的距离，相似度95%及以上的图像分为同一个子类。
每个子类中选择 与相似度均值 差异较大的图像作为关键帧。

### 查询
具体来说，在图像检索部分，我们使用VGG16和Resnet-50作为特征提取网络，二者在特征提取阶段互相独立，
并且我们分别在两个特征提取网络之后添加一个Hash层，其节点数作为哈希码的长度。之后我们以Hash层的特征作为特征网络输出结果，
并对其进行加权融合。最后，我们对融合之后的特征向量进行二值化操作，从而得到哈希码。
该哈希码作为输入的查询图像的最终输出特征。然后比较查询图像与数据库中关键帧图像的相似性，
即计算查询图像与关键帧图像集合的哈希码的Hamming距离，最后取距离最小的10张图像作为查询图像的检索结果。


## 本项目的目的
本项目通过以上方法进行IVUS视频影像的关键帧检索，而其两个关键部分关键帧提取和图像检索的目的和意义就在于
可以去除冗余、重复、无用的图像，大大减少计算量，并加快检索速度和准确度，
提高工作效率，进而满足实际应用的需求。

